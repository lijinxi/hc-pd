Ext.define("Ext.ux.BoxReorderer",{requires:["Ext.dd.DD"],mixins:{observable:"Ext.util.Observable"},itemSelector:".x-box-item",animate:100,constructor:function(){this.mixins.observable.constructor.apply(this,arguments)},init:function(a){var b=this;b.container=a;b.animatePolicy={};b.animatePolicy[a.getLayout().names.x]=true;b.container.on({scope:b,boxready:b.onBoxReady,beforedestroy:b.onContainerDestroy})},onContainerDestroy:function(){var a=this.dd;if(a){a.unreg();this.dd=null}},onBoxReady:function(){var c=this,b=c.container.getLayout(),d=b.names,a;a=c.dd=new Ext.dd.DD(b.innerCt,c.container.id+"-reorderer");Ext.apply(a,{animate:c.animate,reorderer:c,container:c.container,getDragCmp:c.getDragCmp,clickValidator:Ext.Function.createInterceptor(a.clickValidator,c.clickValidator,c,false),onMouseDown:c.onMouseDown,startDrag:c.startDrag,onDrag:c.onDrag,endDrag:c.endDrag,getNewIndex:c.getNewIndex,doSwap:c.doSwap,findReorderable:c.findReorderable});a.dim=d.width;a.startAttr=d.beforeX;a.endAttr=d.afterX},getDragCmp:function(a){return this.container.getChildByElement(a.getTarget(this.itemSelector,10))},clickValidator:function(b){var a=this.getDragCmp(b);return !!(a&&a.reorderable!==false)},onMouseDown:function(g){var f=this,a=f.container,d,b,c;f.dragCmp=f.getDragCmp(g);if(f.dragCmp){b=f.dragCmp.getEl();f.startIndex=f.curIndex=a.items.indexOf(f.dragCmp);c=b.getBox();f.lastPos=c[f.startAttr];d=a.el.getBox();if(f.dim==="width"){f.minX=d.left;f.maxX=d.right-c.width;f.minY=f.maxY=c.top;f.deltaX=g.getX()-c.left}else{f.minY=d.top;f.maxY=d.bottom-c.height;f.minX=f.maxX=c.left;f.deltaY=g.getY()-c.top}f.constrainY=f.constrainX=true}},startDrag:function(){var b=this,a=b.dragCmp;if(a){a.setPosition=Ext.emptyFn;a.animate=false;if(b.animate){b.container.getLayout().animatePolicy=b.reorderer.animatePolicy}b.dragElId=a.getEl().id;b.reorderer.fireEvent("StartDrag",b,b.container,a,b.curIndex);a.suspendEvents();a.disabled=true;a.el.setStyle("zIndex",100)}else{b.dragElId=null}},findReorderable:function(c){var d=this,a=d.container.items,b;if(a.getAt(c).reorderable===false){b=a.getAt(c);if(c>d.startIndex){while(b&&b.reorderable===false){c++;b=a.getAt(c)}}else{while(b&&b.reorderable===false){c--;b=a.getAt(c)}}}c=Math.min(Math.max(c,0),a.getCount()-1);if(a.getAt(c).reorderable===false){return -1}return c},doSwap:function(d){var f=this,b=f.container.items,a=f.container,e=f.container._isLayoutRoot,h,c,g;d=f.findReorderable(d);if(d===-1){return}f.reorderer.fireEvent("ChangeIndex",f,a,f.dragCmp,f.startIndex,d);h=b.getAt(f.curIndex);c=b.getAt(d);b.remove(h);g=Math.min(Math.max(d,0),b.getCount()-1);b.insert(g,h);b.remove(c);b.insert(f.curIndex,c);a._isLayoutRoot=true;a.updateLayout();a._isLayoutRoot=e;f.curIndex=d},onDrag:function(c){var b=this,a;a=b.getNewIndex(c.getPoint());if((a!==undefined)){b.reorderer.fireEvent("Drag",b,b.container,b.dragCmp,b.startIndex,b.curIndex);b.doSwap(a)}},endDrag:function(d){if(d){d.stopEvent()}var c=this,b=c.container.getLayout(),a;if(c.dragCmp){delete c.dragElId;delete c.dragCmp.setPosition;c.dragCmp.animate=true;c.dragCmp.lastBox[b.names.x]=c.dragCmp.getPosition(true)[b.names.widthIndex];c.container._isLayoutRoot=true;c.container.updateLayout();c.container._isLayoutRoot=undefined;a=Ext.fx.Manager.getFxQueue(c.dragCmp.el.id)[0];if(a){a.on({afteranimate:c.reorderer.afterBoxReflow,scope:c})}else{Ext.Function.defer(c.reorderer.afterBoxReflow,1,c)}if(c.animate){delete b.animatePolicy}c.reorderer.fireEvent("drop",c,c.container,c.dragCmp,c.startIndex,c.curIndex)}},afterBoxReflow:function(){var a=this;a.dragCmp.el.setStyle("zIndex","");a.dragCmp.disabled=false;a.dragCmp.resumeEvents()},getNewIndex:function(h){var g=this,a=g.getDragEl(),b=Ext.fly(a).getBox(),l,f,k,d=0,c=g.container.items.items,e=c.length,j=g.lastPos;g.lastPos=b[g.startAttr];for(;d<e;d++){l=c[d].getEl();if(l.is(g.reorderer.itemSelector)){f=l.getBox();k=f[g.startAttr]+(f[g.dim]>>1);if(d<g.curIndex){if((b[g.startAttr]<j)&&(b[g.startAttr]<(k-5))){return d}}else{if(d>g.curIndex){if((b[g.startAttr]>j)&&(b[g.endAttr]>(k+5))){return d}}}}}}});
Ext.define("Ext.ux.ComboPageSize",{constructor:function(a){if(a){Ext.apply(this,a)}},init:function(a){var d,c=this;var b=c.pageList||[25,50,100,300,500],e=c.defaultSize||25;Ext.Array.include(b,e);b.sort(function(g,f){return g>f?1:-1});d=Ext.widget("combo",{triggerAction:"all",lazyRender:true,mode:"local",width:70,editable:false,store:b,value:e,listeners:{change:function(g,f){a.store.pageSize=f;a.store.currentPage=1;a.store.load()}}});a.add(0,"-");a.add(0,d);a.on({beforedestroy:function(){d.destroy()}})}});
Ext.define("Ext.ux.IFrame",{extend:"Ext.Component",alias:"widget.uxiframe",loadMask:"Loading...",src:"about:blank",renderTpl:['<iframe src="{src}" id="{id}-iframeEl" data-ref="iframeEl" name="{frameName}" width="100%" height="100%" frameborder="0"></iframe>'],childEls:["iframeEl"],initComponent:function(){this.callParent();this.frameName=this.frameName||this.id+"-frame"},initEvents:function(){var a=this;a.callParent();a.iframeEl.on("load",a.onLoad,a)},initRenderData:function(){return Ext.apply(this.callParent(),{src:this.src,frameName:this.frameName})},getBody:function(){var a=this.getDoc();return a.body||a.documentElement},getDoc:function(){try{return this.getWin().document}catch(a){return null}},getWin:function(){var b=this,a=b.frameName,c=Ext.isIE?b.iframeEl.dom.contentWindow:window.frames[a];return c},getFrame:function(){var a=this;return a.iframeEl.dom},beforeDestroy:function(){this.cleanupListeners(true);this.callParent()},cleanupListeners:function(c){var b,d;if(this.rendered){try{b=this.getDoc();if(b){Ext.get(b).un(this._docListeners);if(c){for(d in b){if(b.hasOwnProperty&&b.hasOwnProperty(d)){delete b[d]}}}}}catch(a){}}},onLoad:function(){var b=this,d=b.getDoc(),a=b.onRelayedEvent;if(d){try{Ext.get(d).on(b._docListeners={mousedown:a,mousemove:a,mouseup:a,click:a,dblclick:a,scope:b})}catch(c){}Ext.get(this.getWin()).on("beforeunload",b.cleanupListeners,b);this.el.unmask();this.fireEvent("load",this)}else{if(b.src){this.el.unmask();this.fireEvent("error",this)}}},onRelayedEvent:function(c){var b=this.iframeEl,d=b.getTrueXY(),e=c.getXY(),a=c.getTrueXY();c.xy=[d[0]+a[0],d[1]+a[1]];c.injectEvent(b);c.xy=e},load:function(d){var a=this,c=a.loadMask,b=a.getFrame();if(a.fireEvent("beforeload",a,d)!==false){if(c&&a.el){a.el.mask(c)}b.src=a.src=(d||a.src)}}});
Ext.define("Ext.ux.TabCloseMenu",{extend:"Ext.plugin.Abstract",alias:"plugin.tabclosemenu",mixins:{observable:"Ext.util.Observable"},closeTabText:"Close Tab",showCloseOthers:true,closeOthersTabsText:"Close Other Tabs",showCloseAll:true,closeAllTabsText:"Close All Tabs",extraItemsHead:null,extraItemsTail:null,constructor:function(a){this.callParent([a]);this.mixins.observable.constructor.call(this,a)},init:function(a){this.tabPanel=a;this.tabBar=a.down("tabbar");this.mon(this.tabPanel,{scope:this,afterlayout:this.onAfterLayout,single:true})},onAfterLayout:function(){this.mon(this.tabBar.el,{scope:this,contextmenu:this.onContextMenu,delegate:".x-tab"})},destroy:function(){this.callParent();Ext.destroy(this.menu)},onContextMenu:function(d,f){var c=this,g=c.createMenu(),e=true,h=true,b=c.tabBar.getChildByElement(f),a=c.tabBar.items.indexOf(b);c.item=c.tabPanel.getComponent(a);g.child("#close").setDisabled(!c.item.closable);if(c.showCloseAll||c.showCloseOthers){c.tabPanel.items.each(function(i){if(i.closable){e=false;if(i!==c.item){h=false;return false}}return true});if(c.showCloseAll){g.child("#closeAll").setDisabled(e)}if(c.showCloseOthers){g.child("#closeOthers").setDisabled(h)}}d.preventDefault();c.fireEvent("beforemenu",g,c.item,c);g.showAt(d.getXY())},createMenu:function(){var b=this;if(!b.menu){var a=[{itemId:"close",text:b.closeTabText,scope:b,handler:b.onClose}];if(b.showCloseAll||b.showCloseOthers){a.push("-")}if(b.showCloseOthers){a.push({itemId:"closeOthers",text:b.closeOthersTabsText,scope:b,handler:b.onCloseOthers})}if(b.showCloseAll){a.push({itemId:"closeAll",text:b.closeAllTabsText,scope:b,handler:b.onCloseAll})}if(b.extraItemsHead){a=b.extraItemsHead.concat(a)}if(b.extraItemsTail){a=a.concat(b.extraItemsTail)}b.menu=Ext.create("Ext.menu.Menu",{items:a,listeners:{hide:b.onHideMenu,scope:b}})}return b.menu},onHideMenu:function(){var a=this;a.fireEvent("aftermenu",a.menu,a)},onClose:function(){this.tabPanel.remove(this.item)},onCloseOthers:function(){this.doClose(true)},onCloseAll:function(){this.doClose(false)},doClose:function(b){var a=[];this.tabPanel.items.each(function(c){if(c.closable){if(!b||c!==this.item){a.push(c)}}},this);Ext.suspendLayouts();Ext.Array.forEach(a,function(c){this.tabPanel.remove(c)},this);Ext.resumeLayouts(true)}});
Ext.define("Ext.ux.TabReorderer",{extend:"Ext.ux.BoxReorderer",alias:"plugin.tabreorderer",itemSelector:"."+Ext.baseCSSPrefix+"tab",init:function(b){var a=this;a.callParent([b.getTabBar()]);b.onAdd=Ext.Function.createSequence(b.onAdd,a.onAdd)},onBoxReady:function(){var c,a,b=0,d;this.callParent(arguments);for(c=this.container.items.items,a=c.length;b<a;b++){d=c[b];if(d.card){d.reorderable=d.card.reorderable}}},onAdd:function(b,a){b.tab.reorderable=b.reorderable},afterBoxReflow:function(){var a=this;Ext.ux.BoxReorderer.prototype.afterBoxReflow.apply(a,arguments);if(a.dragCmp){a.container.tabPanel.setActiveTab(a.dragCmp.card);a.container.tabPanel.move(a.startIndex,a.curIndex)}}});
Ext.ns("Ext.ux");Ext.define("Ext.ux.TabScrollerMenu",{alias:"plugin.tabscrollermenu",requires:["Ext.menu.Menu"],pageSize:10,maxText:15,menuPrefixText:"Items",constructor:function(a){Ext.apply(this,a)},init:function(b){var a=this;a.tabPanel=b;b.on({render:function(){a.tabBar=b.tabBar;a.layout=a.tabBar.layout;a.layout.overflowHandler.handleOverflow=Ext.Function.bind(a.showButton,a);a.layout.overflowHandler.clearOverflow=Ext.Function.createSequence(a.layout.overflowHandler.clearOverflow,a.hideButton,a)},destroy:a.destroy,scope:a,single:true})},showButton:function(){var c=this,a=Ext.getClass(c.layout.overflowHandler).prototype.handleOverflow.apply(c.layout.overflowHandler,arguments),b=c.menuButton;if(c.tabPanel.items.getCount()>1){if(!b){b=c.menuButton=c.tabBar.body.createChild({cls:Ext.baseCSSPrefix+"tab-tabmenu-right"},c.tabBar.body.child("."+Ext.baseCSSPrefix+"box-scroller-right"));b.addClsOnOver(Ext.baseCSSPrefix+"tab-tabmenu-over");b.on("click",c.showTabsMenu,c)}b.setVisibilityMode(Ext.dom.Element.DISPLAY);b.show();a.reservedSpace+=b.getWidth()}else{c.hideButton()}return a},hideButton:function(){var a=this;if(a.menuButton){a.menuButton.hide()}},getPageSize:function(){return this.pageSize},setPageSize:function(a){this.pageSize=a},getMaxText:function(){return this.maxText},setMaxText:function(a){this.maxText=a},getMenuPrefixText:function(){return this.menuPrefixText},setMenuPrefixText:function(a){this.menuPrefixText=a},showTabsMenu:function(d){var a=this;if(a.tabsMenu){a.tabsMenu.removeAll()}else{a.tabsMenu=new Ext.menu.Menu()}a.generateTabMenuItems();var c=Ext.get(d.getTarget()),b=c.getXY();b[1]+=24;a.tabsMenu.showAt(b)},generateTabMenuItems:function(){var l=this,h=l.tabPanel,a=h.getActiveTab(),j=h.items.getRange(),m=l.getPageSize(),e=l.tabsMenu,q,d,o,f,k,b,n,p,c,g;e.suspendLayouts();j=Ext.Array.filter(j,function(i){if(i.id==a.id){return false}return i.hidden?!!i.hiddenByLayout:true});q=j.length;d=Math.floor(q/m);o=q%m;if(q>m){for(f=0;f<d;f++){k=(f+1)*m;b=[];for(n=0;n<m;n++){g=n+k-m;p=j[g];b.push(l.autoGenMenuItem(p))}e.add({text:l.getMenuPrefixText()+" "+(k-m+1)+" - "+k,menu:b})}if(o>0){c=d*m;b=[];for(f=c;f<q;f++){p=j[f];b.push(l.autoGenMenuItem(p))}l.tabsMenu.add({text:l.menuPrefixText+" "+(c+1)+" - "+(c+b.length),menu:b})}}else{for(f=0;f<q;++f){e.add(l.autoGenMenuItem(j[f]))}}e.resumeLayouts(true)},autoGenMenuItem:function(b){var a=this.getMaxText(),c=Ext.util.Format.ellipsis(b.title,a);return{text:c,handler:this.showTabFromMenu,scope:this,disabled:b.disabled,tabToShow:b,iconCls:b.iconCls}},showTabFromMenu:function(a){this.tabPanel.setActiveTab(a.tabToShow)},destroy:function(){Ext.destroy(this.tabsMenu,this.menuButton)}});
Ext.define("Ext.ux.ToolbarDroppable",{constructor:function(a){Ext.apply(this,a)},init:function(a){this.toolbar=a;this.toolbar.on({scope:this,render:this.createDropTarget})},createDropTarget:function(){this.dropTarget=Ext.create("Ext.dd.DropTarget",this.toolbar.getEl(),{notifyOver:Ext.Function.bind(this.notifyOver,this),notifyDrop:Ext.Function.bind(this.notifyDrop,this)})},addDDGroup:function(a){this.dropTarget.addToGroup(a)},calculateEntryIndex:function(h){var j=0,k=this.toolbar,i=k.items.items,f=i.length,b=h.getXY()[0],g=0,c,d,a,l;for(;g<f;g++){c=i[g].getEl();d=c.getXY()[0];a=c.getWidth();l=d+a/2;if(b<l){j=g;break}else{j=g+1}}return j},canDrop:function(a){return true},notifyOver:function(a,b,c){return this.canDrop.apply(this,arguments)?this.dropTarget.dropAllowed:this.dropTarget.dropNotAllowed},notifyDrop:function(a,d,e){var c=this.canDrop(a,d,e),f=this.toolbar;if(c){var b=this.calculateEntryIndex(d);f.insert(b,this.createItem(e));f.doLayout();this.afterLayout()}return c},createItem:function(a){Ext.Error.raise("The createItem method must be implemented in the ToolbarDroppable plugin")},afterLayout:Ext.emptyFn});
Ext.define("Ext.ux.grid.MultiFilter",{extend:"Ext.container.Container",alias:"plugin.gridmultifilter",layout:"hbox",dock:"top",baseCls:"saki-gms-ct",filterOnEnter:false,iconColumn:true,filterAfterRender:true,height:21,weight:1000,buffer:500,clearItemT:"Clear Filter",clearItemIconCls:"icon-clear-filter",saveItemT:"Save Filter",saveItemIconCls:"icon-disk",init:function(e){var d=this,f=e.getView().getHeaderCt();Ext.apply(d,{grid:e,store:e.getStore(),headerCt:f,values:{}});f.on({afterlayout:{fn:d.afterHdLayout,scope:d},afterrender:{fn:d.afterHdRender,scope:d,single:true},beforerender:{fn:d.beforeHdRender,scope:d,single:true},columnmove:{fn:d.onColumnMove,scope:d}});e.getFilter=function(){return d}},createFilterMenu:function(){var c=this,d;if(!c.filterMenu){d=c.getSavedFilters();if(d.length){d.push("-")}d.push({text:c.clearItemT,iconCls:c.clearItemIconCls,scope:c,handler:c.clearValues});c.filterMenu=Ext.widget("menu",{defaultAlign:"tr-br?",items:d})}},getSavedFilters:function(){return[]},getFields:function(){var c=this,d=[];c.headerCt.items.each(function(b){var f=b.filter,h={xtype:"component"},a=null;if(true===f){h.xtype="textfield"}else{if(f&&f.isComponent){h=f}else{if("string"===typeof f){h.xtype=f}else{if(Ext.isObject(f)){Ext.apply(h,f)}else{h.cls="saki-gms-nofilter";h.height=c.height}}}}if("iconCol"===b.itemId){Ext.apply(h,{autoEl:{tag:"div",children:[{tag:"img",src:"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",cls:"saki-gms-icon x-tool-img x-tool-gear"}]},cls:"saki-gms-nofilter x-tool",overCls:"x-tool-over",listeners:{click:{fn:c.onIconClick,scope:c,element:"el"}}})}if("component"!==h.xtype){Ext.apply(h,{itemId:b.dataIndex,enableKeyEvents:true})}a=Ext.widget(h);if(a.isXType("combo")){a.on("select",c.onFieldChange,c,{buffer:c.buffer})}else{a.on("keyup",c.onFieldChange,c,{buffer:c.filterOnEnter?undefined:c.buffer});a.on("change",c.onFieldChange,c,{buffer:c.filterOnEnter?undefined:c.buffer})}d.push(a)});return d},onIconClick:function(f,e){var d=this;if(d.filterMenu){d.filterMenu.showBy(f.getTarget("div.x-tool"))}},onFieldChange:function(h,e){var f=this,g=h.getRawValue();if(f.filterOnEnter&&Ext.EventObject.ENTER!==f.getKey(e)){return}f.doFilterChange();f.updateClearIcon(h)},getKey:function(b){return b&&Ext.isFunction(b.getKey)?b.getKey():false},isDirty:function(){var d=this,e=d.getValues(),f=Ext.encode(d.values)!==Ext.encode(e);return f},updateClearIcon:function(i){var k=this,l="saki-gms-hasvalue",h=i.bodyEl.down("input").up("div"),j=i.getValue(),f;if(false!==i.clearIcon){if(!i.clearIcon){i.clearIcon=h.createChild({tag:"div",cls:"saki-gms-clear"});i.clearIcon.on("click",Ext.bind(k.clearField,k,[i]));h.applyStyles({position:"relative"})}if(j&&!i.readOnly&&!i.disabled){h.addCls(l)}else{h.removeCls(l)}}f=k.headerCt.items.getAt(k.items.indexOf(i)).getEl();if(j){f.addCls("saki-gms-filtered")}else{f.removeCls("saki-gms-filtered")}},syncUi:function(){var b=this;b.items.each(function(a){if(a&&a.rendered&&Ext.isFunction(a.getValue)){b.updateClearIcon(a)}})},clearField:function(b){if(b&&Ext.isFunction(b.setValue)&&!b.readOnly&&!b.disabled){b.setValue("");this.onFieldChange(b)}b.focus()},doFilterChange:function(){var c=this,d=c.store;if(!c.isDirty()){return}c.values=c.getValues();if(d.filters){d.filters.removeAll()}if(c.values){d.filter(c.getFilters())}else{d.clearFilter()}c.syncUi()},getFilters:function(){var c=this,d=[];Ext.Object.each(c.values,function(h,b){var a,f;a=c.items.get(h);f={property:h,value:b};if(a&&Ext.isFunction(a.filterFn)){f.filterFn=Ext.Function.bind(a.filterFn,null,[h,b],true)}d.push(f)});return d},setValues:function(e){var d=this,f;if(e&&Ext.isObject(e)){d.clearValues(true);Ext.Object.each(e,function(b,a){f=d.items.get(b);if(f&&Ext.isFunction(f.setValue)){f.setValue(a)}})}d.onFieldChange()},clearValues:function(d){var c=this;c.items.each(function(a){c.clearField(a)});if(!d){c.doFilterChange()}},getValues:function(){var e=this,f={},g,h=true;e.items.each(function(a){if(Ext.isFunction(a.getValue)){g=a.getValue();if(g){f[a.itemId]=g;h=false}}});return h?null:f},syncCols:function(){var d=this,c=d.headerCt.items;c.each(function(b,a){d.items.getAt(a).setWidth(b.getWidth())})},onGridScroll:function(){var c=this,d=c.grid.getView().getEl().getScroll();c.getLayout().innerCt.scrollTo("left",d.left)},onColumnMove:function(h,g,f,i){var j=this;j.move(f,f>i?i:i-1);j.syncCols()},afterHdLayout:function(){var b=this;b.syncCols();b.syncUi()},beforeHdRender:function(){var b=this.headerCt;this.iconCol=b.add({width:21,menuDisabled:true,hideable:false,sortable:false,itemId:"iconCol",draggable:false,hoverCls:"",baseCls:"",renderer:function(a,d){}})},afterHdRender:function(){var c=this,d=c.grid;c.add(c.getFields());d.dockedItems.add(c);d.getView().on({bodyscroll:{fn:c.onGridScroll,scope:c}});if(c.isDirty()&&c.filterAfterRender){c.doFilterChange()}c.createFilterMenu()}});
Ext.define("Ext.ux.grid.SimpleFilter",{extend:"Ext.AbstractPlugin",alias:"plugin.gridsimplefilter",targetCt:"toolbar[dock=bottom]",targetCtScope:"grid",autoCreate:true,searchPosition:"tbfill",triggerHidden:false,beforeSeparator:true,triggerSearch:"auto",minChars:2,focusOnLoad:true,buttonHidden:false,buttonCls:"saki-gridsearch-btn",fontIcons:true,buttonGlyph:"xe800@fontello",mode:"remote",queryParam:"query",fieldsParam:"fields",checkIndexes:"all",disableIndexes:[],buffer:400,inputType:"search",showSelectAll:true,noCtText:"Target container was not found. Check values of autoCreate and targetCt config options.",searchText:"Search",selectAllText:"Select all",autoTipText:"Type at least {0} characters",manualTipText:"Type a text and press Enter",init:function(d){var e=this,f;e.callParent(arguments);e.targetCt=f=e.getTargetCt();if(!f){Ext.Error.raise(e.noCtText)}e.disableIndexes=Ext.Array.slice(e.disableIndexes);e.createField();d.on("reconfigure",e.reconfigure,e)},doSearch:function(o){var n=this,s=n.menu,m=n.field,f=n.getCmp().getStore(),p=f.getProxy(),t=n.getCmp(),l=n.queryParam,r=n.fieldsParam,q=s.getFields();if(o){m.setRawValue(o)}else{o=m.getValue()}if("remote"===n.mode){delete p.extraParams[l];delete p.extraParams[r];if(o){p.extraParams[l]=o}if(q){p.extraParams[r]=Ext.encode(q)}f.loadPage(1)}else{if(q){f.clearFilter();if(o){f.filterBy(function(e){var a=false,d,c,b=n.dateFormat;Ext.each(q,function(g){if(a){return}d=e.get(g);if(Ext.isDate(d)){b=b||t.headerCt.items.findBy(function(h){return h.dataIndex===g}).format;b=b||e.fields.get(g).dateFormat;b=b||Ext.Date.defaultFormat;d=Ext.Date.format(d,b)}c=new RegExp(n.escapeRegExp(o),"gi");a=c.test(d)});return !!a})}}}},reconfigure:function(){var k=this,l=k.getCmp(),h=l.getStore(),f=l.headerCt.items,i=k.menu,j="radio"===k.menuStyle?"g"+(new Date()).getTime():undefined;i.removeAll();if(k.showSelectAll){i.add([{xtype:"menucheckitem",text:k.selectAllText,checked:"all"===k.checkIndexes,group:j,handler:function(a){a.parentMenu.items.each(function(b){if(b.setChecked&&!b.isDisabled()&&b!==a){b.setChecked(a.checked,true)}})}},"-"])}f.each(function(b){var a="all"===k.checkIndexes||Ext.Array.contains(k.checkIndexes,b.dataIndex);if(b.text&&b.dataIndex&&!Ext.Array.contains(k.disableIndexes,b.dataIndex)){i.add({xtype:"menucheckitem",text:b.text,group:j,checked:a,dataIndex:b.dataIndex})}});if(k.focusOnLoad){h.on({load:{fn:function(){k.field.focus()},delay:100}})}h.setProxy(h.getProxy().clone())},createField:function(){var j=this,h=j.targetCt,g=j.searchPosition,i=j.createAdder(),f=[];if("last"===g&&"right"===j.searchAlign){f.push("->")}if(j.beforeSeparator){f.push("-")}j.menu=Ext.widget({xtype:"menu",listeners:{scope:j,hide:j.onMenuHide,show:j.onMenuShow},getFields:function(){var a=this,b=[];a.items.each(function(c){if(c.checked&&c.dataIndex){b.push(c.dataIndex)}});return b}});f.push({xtype:"button",text:j.searchText,menu:j.menu,hidden:j.buttonHidden,cls:j.buttonCls,glyph:j.fontIcons?j.buttonGlyph:undefined,iconCls:j.fontIcons?undefined:j.buttonIconCls});f.push({xtype:"triggerfield",inputType:j.inputType,inputCls:"x-form-text",isFormField:false,fieldStyle:"-webkit-appearance:textfield",hideTrigger:j.triggerHidden||"auto"===j.triggerSearch,triggerCls:"x-form-search-trigger",onTriggerClick:Ext.Function.bind(j.doSearch,j,[]),listeners:{scope:j,buffer:j.buffer,change:j.onChange,specialkey:j.onSpecialKey,render:j.onFieldRender}});if(j.afterSeparator){f.push("-")}i(f);Ext.apply(j,{field:h.down("triggerfield[inputType="+j.inputType+"]"),button:h.down("button[cls="+j.buttonCls+"]")});j.reconfigure()},onFieldRender:function(c){var d=this;if(!d.disableTip){Ext.tip.QuickTipManager.register({target:c.inputEl.dom,text:"auto"===d.triggerSearch?Ext.String.format(d.autoTipText,d.minChars):d.manualTipText})}if("search"===d.inputType){}},onMenuHide:function(f){var d=this,e=f.getFields();if(Ext.encode(d.lastFields)!==Ext.encode(e)&&e.length&&d.field.getValue()){d.doSearch()}d.setFieldDisabled(!e.length)},onMenuShow:function(b){this.lastFields=b.getFields()},onSpecialKey:function(c,d){if(d.getKey()==d.ENTER){this.doSearch()}},onChange:function(g){var e=this,h=g.getValue(),f=e.minChars;if("auto"===e.triggerSearch&&f&&h.length>=f||0===h.length){e.doSearch()}},createAdder:function(){var i=this,g=i.searchPosition,h=i.targetCt,j,f;if(Ext.isNumber(g)){return Ext.Function.bind(h.insert,h,[g],0)}if("first"===g){return Ext.Function.bind(h.insert,h,[0],0)}if("last"===g){return Ext.Function.bind(h.add,h)}j=h.down(g);if(j){f=h.items.indexOf(j);return Ext.Function.bind(h.insert,h,[f],0)}else{return Ext.Function.bind(h.add,h)}},getTargetCt:function(){var h=this,e=h.getCmp(),g="global"===h.targetCtScope?Ext.ComponentQuery.query(h.targetCt)[0]:e.down(h.targetCt),f;if(!g&&h.autoCreate){f=h.targetCt.match(/(top|left|bottom|right)/);f=f?f[0]:"bottom";g=e.dockedItems.add(Ext.widget({xtype:"toolbar",dock:f}))}return g},isDisabled:function(){return this.field.isDisabled()},isVisible:function(){return this.field.isVisible()},setButtonDisabled:function(b){this.button.setDisabled(b)},disableButton:function(){this.button.disable()},enableButton:function(){this.button.enable()},setFieldDisabled:function(b){this.field.setDisabled(b)},disableField:function(){this.field.disable()},enableField:function(){this.field.enable()},setDisabled:function(d){var c=this;c.setButtonDisabled(d);c.setFieldDisabled(d)},disable:function(){var b=this;b.disableButton();b.disableField()},enable:function(){var b=this;b.enableButton();b.enableField()},setHidden:function(c){var d=this;d.setButtonHidden(c);d.setFieldHidden(c)},hide:function(){this.setHidden(true)},show:function(){this.setHidden(false)},setButtonHidden:function(c){var d=this;if(c){d.button.hide()}else{d.button.show()}},hideButton:function(){this.setButtonHidden(true)},showButton:function(){this.setButtonHidden(false)},setFieldHidden:function(c){var d=this;if(c){d.field.hide()}else{d.field.show()}},hideField:function(){this.setFieldHidden(true)},showField:function(){this.setFieldHidden(false)},escapeRegExp:function(b){if("string"!==typeof b){return b}return b.replace(/([.*+?\^=!:${}()|\[\]\/\\])/g,"\\$1")}});
